
				<!DOCTYPE html>
				<html>
					<head>
						<meta charset="UTF-8">
						<meta name="viewport" content="width=device-width, initial-scale=1" />
						<link rel="stylesheet" href="pluginAssets/highlight.js/atom-one-light.css">
						<title>17/03/2024 - 23/03/2024</title>
					</head>
					<body>
						<div class="exported-note"><div class="exported-note-title">17/03/2024 - 23/03/2024</div>

<style>
		/* https://necolas.github.io/normalize.css/ */
		html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}
		article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}
		pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}
		b,strong{font-weight:bolder}small{font-size:80%}img{border-style:none}

		body {
			font-size: 15px;
			color: #32373F;
			word-wrap: break-word;
			line-height: 1.6em;
			background-color: #ffffff;
			font-family: 'Avenir Next', 'Avenir', 'Arial', sans-serif;
			padding-bottom: 0px;
			padding-top: 0px;
		}
		kbd {
			border: 1px solid rgb(220, 220, 220);
			box-shadow: inset 0 -1px 0 rgb(220, 220, 220);
			padding: 2px 4px;
			border-radius: 3px;
			background-color: rgb(243, 243, 243);
		}
		::-webkit-scrollbar {
			width: 7px;
			height: 7px;
		}
		::-webkit-scrollbar-corner {
			background: none;
		}
		::-webkit-scrollbar-track {
			border: none;
		}
		::-webkit-scrollbar-thumb {
			background: rgba(100, 100, 100, 0.3); 
			border-radius: 5px;
		}
		::-webkit-scrollbar-track:hover {
			background: rgba(0, 0, 0, 0.1); 
		}
		::-webkit-scrollbar-thumb:hover {
			background: rgba(100, 100, 100, 0.7); 
		}

		

		/* Remove top padding and margin from first child so that top of rendered text is aligned to top of text editor text */

		#rendered-md > h1:first-child,
		#rendered-md > h2:first-child,
		#rendered-md > h3:first-child,
		#rendered-md > h4:first-child,
		#rendered-md > ul:first-child,
		#rendered-md > ol:first-child,
		#rendered-md > table:first-child,
		#rendered-md > blockquote:first-child,
		#rendered-md > img:first-child,
		#rendered-md > p:first-child {
			margin-top: 0;
			padding-top: 0;
		}
		
		p, h1, h2, h3, h4, h5, h6, ul, table {
			margin-top: .6em;
			margin-bottom: 1.35em;

			/*
				Adds support for RTL text in the note body. It automatically detects the direction using the content.
				Issue: https://github.com/laurent22/joplin/issues/3991
			*/
			unicode-bidi: plaintext;
		}

		h1, h2, h3, h4, h5, h6, ul, table {
			margin-bottom: 0.65em;
		}

		h1, h2, h3, h4, h5, h6 {
			line-height: 1.5em;
		}
		h1 {
			font-size: 1.5em;
			font-weight: bold;
			border-bottom: 1px solid #dddddd;
			padding-bottom: .3em;
		}
		h2 {
			font-size: 1.3em;
			font-weight: bold;
			padding-bottom: .1em; */
		}
		h3 {
			font-size: 1.1em;
			font-weight: bold;
		}
		h4, h5, h6 {
			font-size: 1em;
			font-weight: bold;
		}

		.exported-note-title {
			font-size: 2em;
			font-weight: bold;
			margin-bottom: 0.8em;
			line-height: 1.5em;
			padding-bottom: .35em;
			border-bottom: 1px solid #dddddd;
		}

		a {
			color: #155BDA;
		}
		ul, ol {
			padding-left: 0;
			margin-left: 1.7em;
		}
		li {
			margin-bottom: .4em;
		}
		li p {
			margin-top: 0.2em;
			margin-bottom: 0;
		}

		.resource-icon {
			display: inline-block;
			position: relative;
			top: 0.3em;
			text-decoration: none;
			width: 1.2em;
			height: 1.4em;
			margin-right: 0.4em;
			background-color:  #155BDA;
		}
    /* These icons are obtained from the wonderful ForkAwesome project by copying the src svgs 
     * into the css classes below.
     * svgs are obtained from https://github.com/ForkAwesome/Fork-Awesome/tree/master/src/icons/svg
     * instead of the svg width, height property you must use a viewbox here, 0 0 1536 1792 is typically the actual size of the icon
     * each line begins with the pre-amble -webkit-mask: url("data:image/svg+xml;utf8,
     * and of course finishes with ");
     * to prevent artifacts it is also necessary to include -webkit-mask-repeat: no-repeat;
     * on the following line
     * */
		.fa-joplin {
			/* Awesome Font file */
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M373.834 128C168.227 128 0 296.223 0 501.834v788.336C0 1495.778 168.227 1664 373.834 1664h788.336c205.608 0 373.83-168.222 373.83-373.83V501.834C1536 296.224 1367.778 128 1162.17 128zm397.222 205.431h417.424a7.132 7.132 0 0 1 7.132 7.133v132.552c0 4.461-3.619 8.073-8.077 8.073h-57.23c-24.168 0-43.768 19.338-44.284 43.374v2.377h-.017v136.191h-.053l-.466 509.375c-5.02 77.667-39.222 149.056-96.324 201.046-60.28 54.834-141.948 85.017-229.962 85.017-12.45 0-25.208-.61-37.907-1.785-92.157-8.682-181.494-48.601-251.662-112.438-71.99-65.517-117.147-150.03-127.164-238-11.226-98.763 23.42-192.783 95.045-257.937 81.99-74.637 198.185-101.768 316.613-75.704 5.574 1.227 9.55 6.282 9.55 11.997v199.52c-.199 2.625-1.481 6.599-8.183 2.896-.663-.365-1.194-.511-1.653-.531-21.987-10.587-45.159-17.57-68.559-19.916-.38-.04-.757-.124-1.138-.163-.537-.048-1.034-.033-1.556-.075-4.13-.354-8.183-.517-12.203-.58-.87-.011-1.771-.127-2.641-.127-.486 0-.951.05-1.437.057-1.464.011-2.886.115-4.33.163-2.76.102-5.497.211-8.182.448-.273.024-.547.07-.835.097-25.509 2.4-47.864 11.104-65.012 25.47-.954.802-1.974 1.53-2.9 2.36a1.34 1.34 0 0 1-.168.146c-23.96 21.8-34.881 53.872-30.726 90.316 4.62 40.737 26.94 81.156 62.841 113.823 35.908 32.67 80.335 52.977 125.113 57.186 35.118 3.36 66.547-3.919 89.899-20.461a97.255 97.255 0 0 0 9.365-7.501c2.925-2.661 5.569-5.5 8.086-8.416.3-.348.672-.673.975-1.024 8.253-9.864 14.222-21.067 17.996-33.148.639-2.034 1.051-4.148 1.564-6.227.381-1.563.81-3.106 1.112-4.693.555-2.784.923-5.632 1.253-8.49.086-.709.183-1.414.237-2.128.492-4.893.693-9.858.55-14.91h.013V521.623c-2.01-22.626-20.78-40.434-43.928-40.434h-57.23a8.071 8.071 0 0 1-8.077-8.073V340.564a7.132 7.132 0 0 1 7.136-7.133z'/></svg>");
		}
		.fa-file-image {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zm-128-448v320H256v-192l192-192 128 128 384-384zm-832-192c-106 0-192-86-192-192s86-192 192-192 192 86 192 192-86 192-192 192z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-pdf {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zm-514-593c25 20 53 38 84 56 42-5 81-7 117-7 67 0 152 8 177 49 7 10 13 28 2 52-1 1-2 3-3 4v1c-3 18-18 38-71 38-64 0-161-29-245-73-139 15-285 46-392 83-103 176-182 262-242 262-10 0-19-2-28-7l-24-12c-3-1-4-3-6-5-5-5-9-16-6-36 10-46 64-123 188-188 8-5 18-2 23 6 1 1 2 3 2 4 31-51 67-116 107-197 45-90 80-178 104-262-32-109-42-221-24-287 7-25 22-40 42-40h22c15 0 27 5 35 15 12 14 15 36 9 68-1 3-2 6-4 8 1 3 1 5 1 8v30c-1 63-2 123-14 192 35 105 87 190 146 238zm-576 411c30-14 73-57 137-158-75 58-122 124-137 158zm398-920c-10 28-10 76-2 132 3-16 5-31 7-44 2-17 5-31 7-43 1-3 2-5 4-8-1-1-1-3-2-5-1-18-7-29-13-36 0 2-1 3-1 4zm-124 661c88-35 186-63 284-81-10-8-20-15-29-23-49-43-93-103-127-176-19 61-47 126-83 197-15 28-30 56-45 83zm646-16c-5-5-31-24-140-24 49 18 94 28 124 28 9 0 14 0 18-1 0-1-1-2-2-3z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-word {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zM233 768v107h70l164 661h159l128-485c5-15 8-30 10-46 1-8 2-16 2-24h4l3 24c3 14 4 30 9 46l128 485h159l164-661h70V768h-300v107h90l-99 438c-4 16-6 33-7 46l-2 21h-4c0-6-2-14-3-21-3-13-5-30-9-46L825 768H711l-144 545c-4 16-5 33-8 46l-4 21h-4l-2-21c-1-13-3-30-7-46l-99-438h90V768H233z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-powerpoint {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zm-992-234v106h327v-106h-93v-167h137c43 0 82-2 118-15 90-31 146-124 146-233s-54-193-137-228c-38-15-84-19-130-19H416v107h92v555h-92zm353-280H650V882h120c35 0 62 6 83 18 36 21 56 62 56 115 0 56-20 99-62 120-21 10-47 15-78 15z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-excel {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zm-979-234v106h281v-106h-75l103-161c12-19 18-34 21-34h2c1 4 3 7 5 10 4 8 10 14 17 24l107 161h-76v106h291v-106h-68l-192-273 195-282h67V768H828v107h74l-103 159c-12 19-21 34-21 33h-2c-1-4-3-7-5-10-4-7-9-14-17-23L648 875h76V768H434v107h68l189 272-194 283h-68z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-audio {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zM620 850c12 5 20 17 20 30v544c0 13-8 25-20 30-4 1-8 2-12 2-8 0-16-3-23-9l-166-167H288c-18 0-32-14-32-32v-192c0-18 14-32 32-32h131l166-167c10-9 23-12 35-7zm417 689c19 0 37-8 50-24 83-102 129-231 129-363s-46-261-129-363c-22-28-63-32-90-10-28 23-32 63-9 91 65 80 100 178 100 282s-35 202-100 282c-23 28-19 68 9 90 12 10 26 15 40 15zm-211-148c17 0 34-7 47-20 56-60 87-137 87-219s-31-159-87-219c-24-26-65-27-91-3-25 24-27 65-2 91 33 36 52 82 52 131s-19 95-52 131c-25 26-23 67 2 91 13 11 29 17 44 17z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-video {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zM768 768c70 0 128 58 128 128v384c0 70-58 128-128 128H384c-70 0-128-58-128-128V896c0-70 58-128 128-128h384zm492 2c12 5 20 17 20 30v576c0 13-8 25-20 30-4 1-8 2-12 2-8 0-17-3-23-9l-265-266v-90l265-266c6-6 15-9 23-9 4 0 8 1 12 2z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-archive {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M640 384V256H512v128h128zm128 128V384H640v128h128zM640 640V512H512v128h128zm128 128V640H640v128h128zm700-388c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H768v128H640V128H128v1536h1280zM781 943c85 287 107 349 107 349 5 17 8 34 8 52 0 111-108 192-256 192s-256-81-256-192c0-18 3-35 8-52 0 0 21-62 120-396V768h128v128h79c29 0 54 19 62 47zm-141 465c71 0 128-29 128-64s-57-64-128-64-128 29-128 64 57 64 128 64z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-code {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zM480 768c11-14 31-17 45-6l51 38c14 11 17 31 6 45l-182 243 182 243c11 14 8 34-6 45l-51 38c-14 11-34 8-45-6l-226-301c-8-11-8-27 0-38zm802 301c8 11 8 27 0 38l-226 301c-11 14-31 17-45 6l-51-38c-14-11-17-31-6-45l182-243-182-243c-11-14-8-34 6-45l51-38c14-11 34-8 45 6zm-620 461c-18-3-29-20-26-37l138-831c3-18 20-29 37-26l63 10c18 3 29 20 26 37l-138 831c-3 18-20 29-37 26z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file-alt, .fa-file-csv {
      /* fork-awesome doesn't have csv so we use the text icon */
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280zM384 800c0-18 14-32 32-32h704c18 0 32 14 32 32v64c0 18-14 32-32 32H416c-18 0-32-14-32-32v-64zm736 224c18 0 32 14 32 32v64c0 18-14 32-32 32H416c-18 0-32-14-32-32v-64c0-18 14-32 32-32h704zm0 256c18 0 32 14 32 32v64c0 18-14 32-32 32H416c-18 0-32-14-32-32v-64c0-18 14-32 32-32h704z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		.fa-file {
			-webkit-mask: url("data:image/svg+xml;utf8,<svg viewBox='0 0 1536 1792' xmlns='http://www.w3.org/2000/svg'><path d='M1468 380c37 37 68 111 68 164v1152c0 53-43 96-96 96H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h896c53 0 127 31 164 68zm-444-244v376h376c-6-17-15-34-22-41l-313-313c-7-7-24-16-41-22zm384 1528V640H992c-53 0-96-43-96-96V128H128v1536h1280z'/></svg>");
      -webkit-mask-repeat: no-repeat;
		}
		blockquote {
			border-left: 4px solid rgb(220, 220, 220);
			padding-left: 1.2em;
			margin-left: 0;
			opacity: 0.7;
		}

		.jop-tinymce table,
		table {
			text-align: left;
			border-collapse: collapse;
			border: 1px solid rgb(220, 220, 220);
			background-color: #ffffff;
		}

		.jop-tinymce table td, .jop-tinymce table th,
		table td, th {
			text-align: left;
			padding: .5em 1em .5em 1em;
			font-size: 15;
			color: #32373F;
			font-family: 'Avenir Next', 'Avenir', 'Arial', sans-serif;
		}

		.jop-tinymce table td,
		table td {
			border: 1px solid rgb(220, 220, 220);
		}

		.jop-tinymce table th,
		table th {
			border: 1px solid rgb(220, 220, 220);
			border-bottom: 2px solid rgb(220, 220, 220);
			background-color: rgb(247, 247, 247);
		}

		.jop-tinymce table tr:nth-child(even),
		table tr:nth-child(even) {
			background-color: rgb(247, 247, 247);
		}

		.jop-tinymce table tr:hover,
		table tr:hover {
			background-color: #e5e5e5;
		}

		hr {
			border: none;
			border-bottom: 2px solid #dddddd;
		}
		img {
			max-width: 100%;
			height: auto;
		}
		
		.inline-code,
		.mce-content-body code {
			border: 1px solid rgb(220, 220, 220);
			background-color: rgb(243, 243, 243);
			padding-right: .2em;
			padding-left: .2em;
			border-radius: .25em;
			color: rgb(0,0,0);
			font-size: .9em;
		}

		.highlighted-keyword {
			background-color: #F3B717;
			color: black;
		}

		.not-loaded-resource img {
			width: 1.15em;
			height: 1.15em;
			background: white;
			padding: 2px !important;
			border-radius: 2px;
			box-shadow: 0 1px 3px #000000aa;
		}

		a.not-loaded-resource img {
			margin-right: .2em;
		}

		a.not-loaded-resource {
			display: flex;
			flex-direction: row;
			align-items: center;
		}

		.md-checkbox input[type=checkbox]:checked {
			opacity: 0.7;
		}

		.jop-tinymce ul.joplin-checklist .checked,
		.md-checkbox .checkbox-label-checked {
			opacity: 0.5;
		}

		.exported-note {
			padding: 1em;
		}

		.joplin-editable .joplin-source {
			display: none;
		}

		mark {
			background: #F7D26E;
			color: black;
		}

		/* =============================================== */
		/* For TinyMCE */
		/* =============================================== */

		.mce-content-body {
			/* Note: we give a bit more padding at the bottom, to allow scrolling past the end of the document */
			padding: 5px 10px 10em 0;
		}

		/*
		.mce-content-body code {
			background-color: transparent;
		}
		*/

		.mce-content-body [data-mce-selected=inline-boundary] {
			background-color: transparent;
		}

		.mce-content-body .joplin-editable {
			cursor: pointer !important;
		}

		.mce-content-body.mce-content-readonly {
			opacity: 0.5;
		}

		/* We need that to make sure click events have the A has a target */
		.katex a span {
			pointer-events: none;
		}

		.media-player {
			width: 100%;
			margin-top: 10px;
		}

		.media-player.media-pdf {
			min-height: 35rem;
			width: 100%;
			max-width: 1000px;
			margin: 0;
			border: 0;
			display: block;
		}

		/* Clear the CODE style if the element is within a joplin-editable block */
		.mce-content-body .joplin-editable code {
			border: none;
			background: none;
			padding: 0;
			color: inherit;
			font-size: inherit;
		}

		/* To make code blocks horizontally scrollable */
		/* https://github.com/laurent22/joplin/issues/5740 */
		pre.hljs {
			overflow-x: auto;
		}

		.joplin-table-wrapper{
			overflow-x: auto;
			overflow-y: hidden;
		}

		/* =============================================== */
		/* For TinyMCE */
		/* =============================================== */

		@media print {
			body {
				height: auto !important;
			}

			pre {
				white-space: pre-wrap;
			}

			.code, .inline-code {
				border: 1px solid #CBCBCB;
			}

			#joplin-container-content {
				/* The height of the content is set dynamically by JavaScript (in updateBodyHeight) to go
				   around various issues related to scrolling. However when printing we don't want this
				   fixed size as that would crop the content. So we set it to auto here. "important" is
				   needed to override the style set by JavaScript at the element-level. */
				height: auto !important;
			}
		}
	

				/*
					FOR THE MARKDOWN EDITOR
				*/

				/* Remove the indentation from the checkboxes at the root of the document
				   (otherwise they are too far right), but keep it for their children to allow
				   nested lists. Make sure this value matches the UL margin. */

				li.md-checkbox {
					list-style-type: none;
				}

				li.md-checkbox input[type=checkbox] {
					margin-left: -1.71em;
					margin-right: 0.7em;
				}
				
				ul.joplin-checklist {
					list-style:none;
				}

				/*
					FOR THE RICH TEXT EDITOR
				*/

				ul.joplin-checklist li::before {
					content:"\f14a";
					font-family:"Font Awesome 5 Free";
					background-size: 16px 16px;
					pointer-events: all;
					cursor: pointer;
					width: 1em;
					height: 1em;
					margin-left: -1.3em;
					position: absolute;
					color: #32373F;
				}

				.joplin-checklist li:not(.checked)::before {
					content:"\f0c8";
				}
.mermaid { width: 640px; }
pre.mermaid > svg { white-space: unset; }
.mermaid-export-graph {
					opacity: 0;
					height: 0;
					z-index: 1;
					position: relative;
				} 
				.joplin-editable:hover .mermaid-export-graph,
				.joplin-editable .mermaid-export-graph:has(:focus-visible) {
					opacity: 1;
				}
				.mermaid-export-graph > button:hover {
					background-color: #CBDAF1 !important;
				}</style><div id="rendered-md"><h2 id="17032024-2207">17/03/2024 22:07</h2>
<p>I found the reason and &quot;solution&quot; for this change:</p>
<blockquote>
<p>Change the magic number in this function to correspond to our IP. I hate this code the more I read it.</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">MasterGM2/frontend.cpp:595
+strcpy(master_settings_odb.encoder_fe, &quot;AMC13000&quot;);</pre><pre class="hljs"><code>MasterGM2/frontend<span class="hljs-selector-class">.cpp</span>:<span class="hljs-number">595</span>
+<span class="hljs-built_in">strcpy</span>(master_settings_odb.encoder_fe, <span class="hljs-string">&quot;AMC13000&quot;</span>);</code></pre></div>
<p>overwrite this setting that was set to &quot;AMC1300&quot; as opposed to &quot;AMC13000&quot; I'm not sure where it originally gets set. I think the extra 0 is a result of Lawrence's hijinx to make frontends have 3 digits as opposed to 2.</p>
</blockquote>
<p>First off, the reason this change needs to be made is because the change to midas to allow frontends to have 3 digit labels.</p>
<blockquote>
<p>mfe.cxx line 2580: sprintf(full_frontend_name + strlen(full_frontend_name), &quot;%02d&quot;, frontend_index); --&gt; &gt;sprintf(full_frontend_name + strlen(full_frontend_name), &quot;%03d&quot;, frontend_index);</p>
</blockquote>
<p>But, the master_Settings_odb.encoder_fe is actually the ODB setting under <code class="inline-code">Equipment/MasterGM2/Settings/Globals/Encoder Front End</code>. To make everything &quot;work&quot; as Lawrence intended I had to do a few things:</p>
<ol>
<li><strong>Setup environment</strong></li>
</ol>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">cd /home/installation_testing/packages/experiment/lxedaq/environment_setup
source ./setup_environment.sh</pre><pre class="hljs"><code><span class="hljs-built_in">cd</span> /home/installation_testing/packages/experiment/lxedaq/environment_setup
<span class="hljs-built_in">source</span> ./setup_environment.sh</code></pre></div>
<ol start="2">
<li><strong>Nuke the ODB</strong></li>
</ol>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">$MIDASSYS/bin/odbinit -s 1024MB --cleanup</pre><pre class="hljs"><code><span class="hljs-variable">$MIDASSYS</span><span class="hljs-regexp">/bin/</span>odbinit -s <span class="hljs-number">1024</span>MB --cleanup</code></pre></div>
<ol start="3">
<li><strong>Initialize ODB</strong><br>
First let's generate the MasterGM2 settings:</li>
</ol>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">cd /home/installation_testing/packages/experiment/lxedaq/frontends/CaloReadoutAMC13
./frontend -e DAQ</pre><pre class="hljs"><code>cd <span class="hljs-regexp">/home/i</span>nstallation_testing<span class="hljs-regexp">/packages/</span>experiment<span class="hljs-regexp">/lxedaq/</span>frontends/CaloReadoutAMC13
./frontend -e DAQ</code></pre></div>
<p>It should crash, but generate the ODB path <code class="inline-code">Equipment/MasterGM2/Settings/Globals</code>. Under this path, change <code class="inline-code">Front End Offset</code> to 1 and <code class="inline-code">Encoder Front End</code> to AMC13001. Now we move on to initializing the AMC13001 frontend.<br>
Make sure <code class="inline-code">/home/installation_testing/packages/experiment/lxedaq/frontends/AMC13xx_config.xml</code> looks something like below (notice <code class="inline-code">frontend id=&quot;0&quot;</code>)</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;frontend id=&quot;0&quot;&gt;
    &lt;slot id=&quot;5&quot;  type=&quot;WFD&quot; /&gt;
    &lt;slot id=&quot;11&quot; type=&quot;FC7&quot; /&gt;
&lt;/frontend&gt;</pre><pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">frontend</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;0&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;5&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;WFD&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;11&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;FC7&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">frontend</span>&gt;</span></code></pre></div>
<p>Then run</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">cd /home/installation_testing/packages/experiment/lxedaq/frontends/
./initialize_ODB.sh</pre><pre class="hljs"><code>cd <span class="hljs-regexp">/home/i</span>nstallation_testing<span class="hljs-regexp">/packages/</span>experiment<span class="hljs-regexp">/lxedaq/</span>frontends/
./initialize_ODB.sh</code></pre></div>
<p>Rename <code class="inline-code">Equipment/AMC13000</code> --&gt; <code class="inline-code">Equipment/AMC13001</code> in the ODB, the run:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">cd /home/installation_testing/packages/experiment/lxedaq/frontends/CaloReadoutAMC13
./frontend -i 1 -e DAQ</pre><pre class="hljs"><code>cd <span class="hljs-regexp">/home/i</span>nstallation_testing<span class="hljs-regexp">/packages/</span>experiment<span class="hljs-regexp">/lxedaq/</span>frontends/CaloReadoutAMC13
./frontend -i <span class="hljs-number">1</span> -e DAQ</code></pre></div>
<p>this will fill AMC13001 with the proper Settings, Common, Variables, Statistics, and Monitors information. Finally, change<br>
<code class="inline-code">/home/installation_testing/packages/experiment/lxedaq/frontends/AMC13xx_config.xml</code> frontend id to look something like below</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;frontend id=&quot;1&quot;&gt;
    &lt;slot id=&quot;5&quot;  type=&quot;WFD&quot; /&gt;
    &lt;slot id=&quot;11&quot; type=&quot;FC7&quot; /&gt;
&lt;/frontend&gt;</pre><pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">frontend</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;5&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;WFD&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;11&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;FC7&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">frontend</span>&gt;</span></code></pre></div>
<p>4.Now we can run the master frontend without hardcoding the frontend number</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">cd /home/installation_testing/packages/experiment/lxedaq/frontends/CaloReadoutAMC13
./frontend -e DAQ</pre><pre class="hljs"><code>cd <span class="hljs-regexp">/home/i</span>nstallation_testing<span class="hljs-regexp">/packages/</span>experiment<span class="hljs-regexp">/lxedaq/</span>frontends/CaloReadoutAMC13
./frontend -e DAQ</code></pre></div>
<p>Currently, I'm still stuck with the SFP port error:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">FC7 Initialization Started
FC7_init(174): FC7 Board Presence Check
FC7_init(190): Slot 11: Read FC7 IP Address: 192.168.1.11
FC7_init(241): FC7 Ethernet Communication Check: 1/1
FC7_init(288): Slot 11: FC7 Firmware Hard Reset
FC7_init(298): Waiting 5 s ...
FC7_init(410): Slot 11: Write: Enabled Top SFP Ports
top: 1, enable: 1
FC7_init(420): Waiting 15 s ...
top_mask[10]: 1
FC7_init(450): Slot 11: Read: Enabled Top SFP Ports: 0
[MasterGM2,ERROR] [AMC1300.cpp:451:FC7_init,ERROR] /AMC1300/Settings/FC7-11/: Enabled Top SFP Ports Failure
[MasterGM2,ERROR] [frontend.cpp:904:frontend_init,ERROR] FC7 Initialization Failed</pre><pre class="hljs"><code>FC7 Initialization Started
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">174</span>)</span></span>: FC7 Board Presence Check
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">190</span>)</span></span>: Slot <span class="hljs-number">11</span>: Read FC7 IP Address: <span class="hljs-number">192.168</span>.<span class="hljs-number">1.11</span>
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">241</span>)</span></span>: FC7 Ethernet Communication Check: <span class="hljs-number">1</span>/<span class="hljs-number">1</span>
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">288</span>)</span></span>: Slot <span class="hljs-number">11</span>: FC7 Firmware Hard Reset
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">298</span>)</span></span>: Waiting <span class="hljs-number">5</span> s ...
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">410</span>)</span></span>: Slot <span class="hljs-number">11</span>: Write: Enabled Top SFP Ports
<span class="hljs-attribute">top</span>: <span class="hljs-number">1</span>, enable: <span class="hljs-number">1</span>
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">420</span>)</span></span>: Waiting <span class="hljs-number">15</span> s ...
top_mask<span class="hljs-selector-attr">[10]</span>: <span class="hljs-number">1</span>
<span class="hljs-function"><span class="hljs-title">FC7_init</span><span class="hljs-params">(<span class="hljs-number">450</span>)</span></span>: Slot <span class="hljs-number">11</span>: Read: Enabled Top SFP Ports: <span class="hljs-number">0</span>
<span class="hljs-selector-attr">[MasterGM2,ERROR]</span> <span class="hljs-selector-attr">[AMC1300.cpp:451:FC7_init,ERROR]</span> /AMC1300/Settings/FC7-<span class="hljs-number">11</span>/: Enabled Top SFP Ports Failure
<span class="hljs-selector-attr">[MasterGM2,ERROR]</span> <span class="hljs-selector-attr">[frontend.cpp:904:frontend_init,ERROR]</span> FC7 Initialization Failed</code></pre></div>
<hr>
<h2 id="18032024-0152">18/03/2024 01:52</h2>
<p>I tried to reprogram the device with 2GB of bar memory instead of 512KB. I don't think it was sucessful, but 'fe01' did see the device as a PCIe device</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr+ FatalErr- UnsuppReq+ AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</pre><pre class="hljs"><code>[root@fe01 pcimem]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr+ FatalErr- UnsuppReq+ AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</code></pre></div>
<p>Notice there's no specified region (as opposed to below, where there's a 512K &quot;Region 0&quot;):</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# lspci -vv | grep -A 34 &quot;04:00.0&quot;
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 64 bytes
        Interrupt: pin A routed to IRQ 11
        Region 0: Memory at f5f80000 (32-bit, non-prefetchable) [size=512K]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35</pre><pre class="hljs"><code>[root@fe01 pcimem]# lspci -vv | grep -A 34 &quot;04:00.0&quot;
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 64 bytes
        Interrupt: pin A routed to IRQ 11
        Region 0: Memory at f5f80000 (32-bit, non-prefetchable) [size=512K]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35</code></pre></div>
<p>I tried to write and readback to an address, but was unable:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 4126670848 w 0xffffff12
/dev/mem opened.
Target offset is 0xf5f80000, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0xf5f80000)
PCI Memory mapped to address 0x7f758d6f4000.
Value at offset 0xF5F80000 (0x7f758d6f4000): 0xFFFFFFFF
Written 0xFFFFFF12; readback 0xFFFFFFFF</pre><pre class="hljs"><code>[root@fe01 pcimem]# sudo ./pcimem /dev/mem <span class="hljs-number">4126670848</span> w <span class="hljs-number">0xffffff12</span>
/dev/mem opened.
Target offset is <span class="hljs-number">0xf5f80000</span>, page size is <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0xf5f80000</span>)
PCI Memory mapped to address <span class="hljs-number">0x7f758d6f4000</span>.
Value <span class="hljs-meta">at</span> offset <span class="hljs-number">0xF5F80000</span> (<span class="hljs-number">0x7f758d6f4000</span>): <span class="hljs-number">0xFFFFFFFF</span>
Written <span class="hljs-number">0xFFFFFF12</span><span class="hljs-comment">; readback 0xFFFFFFFF</span></code></pre></div>
<p>I'm not sure what I'm even doing here since I see no region to write to/read from.</p>
<hr>
<h2 id="18032024-0218">18/03/2024 02:18</h2>
<p>If I instead reprogram the device with 1MB of BAR memory, I can see the region</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at f5f00000 (32-bit, non-prefetchable) [size=1M]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</pre><pre class="hljs"><code>[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at f5f00000 (32-bit, non-prefetchable) [size=1M]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</code></pre></div>
<p>And I can write and readback in this case:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 4126146560 w 0xffffff12
/dev/mem opened.
Target offset is 0xf5f00000, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0xf5f00000)
PCI Memory mapped to address 0x7fd649f4b000.
Value at offset 0xF5F00000 (0x7fd649f4b000): 0x0
Written 0xFFFFFF12; readback 0xFFFFFF12
[root@fe01 pcimem]#</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 4126146560 w 0xffffff12</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0xf5f00000</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0xf5f00000</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7fd649f4b000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0xF5F00000</span> (<span class="hljs-number">0x7fd649f4b000</span>): <span class="hljs-number">0x0</span>
Written <span class="hljs-number">0xFFFFFF12</span>; readback <span class="hljs-number">0xFFFFFF12</span>
[root@fe01 pcimem]<span class="hljs-comment">#</span></code></pre></div>
<hr>
<h2 id="18032024-0231">18/03/2024 02:31</h2>
<p>AMC13Tool is throwing an error here:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">  void AMC13::buildT1(const std::string&amp; IP, const std::string&amp; AD, 
              const int&amp; IV, const bool&amp; CH) {
    fpga_.resize(2);
    try {
      fpga_.at(T1) = new ipDev(&quot;hcal.crate42.T1&quot;, IP, AD, IV, CH);
    } catch(ipDev::exception&amp; e) {
      printf(&quot;T1 %s %s %i %i\n&quot;, IP.c_str(), AD.c_str(), IV, CH);
      printf(&quot;Failed to build T1 ipDev object!\n&quot;);
      exit(1);
    }
  }</pre><pre class="hljs"><code>  <span class="hljs-keyword">void</span> <span class="hljs-title class_">AMC13</span>::<span class="hljs-title function_ invoke__">buildT1</span>(<span class="hljs-keyword">const</span> std::<span class="hljs-variable constant_">string</span>&amp; IP, <span class="hljs-keyword">const</span> std::<span class="hljs-variable constant_">string</span>&amp; AD, 
              <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span>&amp; IV, <span class="hljs-keyword">const</span> <span class="hljs-keyword">bool</span>&amp; CH) {
    fpga_.<span class="hljs-title function_ invoke__">resize</span>(<span class="hljs-number">2</span>);
    <span class="hljs-keyword">try</span> {
      fpga_.<span class="hljs-title function_ invoke__">at</span>(T1) = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ipDev</span>(<span class="hljs-string">&quot;hcal.crate42.T1&quot;</span>, IP, AD, IV, CH);
    } <span class="hljs-keyword">catch</span>(ip<span class="hljs-title class_">Dev</span>::<span class="hljs-variable constant_">exception</span>&amp; e) {
      <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;T1 %s %s %i %i\n&quot;</span>, IP.<span class="hljs-title function_ invoke__">c_str</span>(), AD.<span class="hljs-title function_ invoke__">c_str</span>(), IV, CH);
      <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;Failed to build T1 ipDev object!\n&quot;</span>);
      <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);
    }
  }</code></pre></div>
<p>Which means ipDev must fail at construction:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">  ipDev::ipDev (const std::string&amp; p_ID, const std::string&amp; p_IP, const std::string&amp; p_AddMap, 
        const int&amp; IpBusV, const bool&amp; ctrlHub) {
    // Build HwInterface ID
    ID = p_ID;
  
    // Build HwInterface URI
    if(!IpBusV) {
      if(ctrlHub)
    URI = &quot;chtcp-1.3://localhost:10203?target=&quot;+p_IP+&quot;:50001&quot;;
      else
    URI = &quot;ipbusudp-1.3://&quot;+p_IP+&quot;:50001&quot;;
    }
    else if(IpBusV) {
      if(ctrlHub)
    URI = &quot;chtcp-2.0://localhost:10203?target=&quot;+p_IP+&quot;:50001&quot;;
      else
    URI = &quot;ipbusudp-2.0://&quot;+p_IP+&quot;:50001&quot;;
    }
    
    // Build HwInterface Address Map
    ADD = &quot;file://&quot;+p_AddMap;
    // Construct HwInterface Object
    try {
      device = new uhal::HwInterface(uhal::ConnectionManager::getDevice(ID, URI, ADD));
    } catch(uhalException&amp; e) {
        std::cerr &lt;&lt; &quot;Address map: &quot; &lt;&lt; ADD&lt;&lt; std::endl;
      std::cerr &lt;&lt; &quot;Caught Exception: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
      throw exception(std::string(&quot;IPbus Creation Failure at URI &quot;+URI));
    }
    // Handle Object's AddressTable entries
    createUhalNodeIDs();
  }</pre><pre class="hljs"><code>  ipDev::ipDev (const std::string&amp; p_ID, const std::string&amp; p_IP, const std::string&amp; p_AddMap, 
        const int&amp; IpBusV, const bool&amp; ctrlHub) {
    // Build HwInterface ID
    ID = p_ID;
  
    // Build HwInterface URI
    if(!IpBusV) {
      if(ctrlHub)
    URI = &quot;chtcp-1.3://localhost:10203?target=&quot;+p_IP+&quot;:50001&quot;;
      else
    URI = &quot;ipbusudp-1.3://&quot;+p_IP+&quot;:50001&quot;;
    }
    else if(IpBusV) {
      if(ctrlHub)
    URI = &quot;chtcp-2.0://localhost:10203?target=&quot;+p_IP+&quot;:50001&quot;;
      else
    URI = &quot;ipbusudp-2.0://&quot;+p_IP+&quot;:50001&quot;;
    }
    
    // Build HwInterface Address Map
    ADD = &quot;file://&quot;+p_AddMap;
    // Construct HwInterface Object
    try {
      device = new uhal::HwInterface(uhal::ConnectionManager::getDevice(ID, URI, ADD));
    } catch(uhalException&amp; e) {
        std::cerr &lt;&lt; &quot;Address map: &quot; &lt;&lt; ADD&lt;&lt; std::endl;
      std::cerr &lt;&lt; &quot;Caught Exception: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
      throw exception(std::string(&quot;IPbus Creation Failure at URI &quot;+URI));
    }
    // Handle Object's AddressTable entries
    createUhalNodeIDs();
  }</code></pre></div>
<p>I added some print statements (as seen above) to see the exception has to do with the address table containing dots (there is a similar problem with using <code class="inline-code">FC7.xml</code> in the gm2daq, which makes me think at some point uHAL stopped liking dots in the address map file)</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@dhcp-10-163-105-238 amc13StandaloneMAN_2014-05-12]#  bin/AMC13Tool -I 192.168.1.188
Connecting to AMC13...
T2 ip 192.168.1.188
T2 ip 192.168.1.188
T1 ip 192.168.1.189
Address map: file://map/AMC13_AddressTable_K7.xml
Caught Exception: Invalid node ID '1.0V_ANA_PWR' specified (contains dots)
T1 192.168.1.189 map/AMC13_AddressTable_K7.xml 1 1
Failed to build T1 ipDev object!</pre><pre class="hljs"><code>[root@dhcp-<span class="hljs-number">10</span>-<span class="hljs-number">163</span>-<span class="hljs-number">105</span>-<span class="hljs-number">238</span> amc13StandaloneMAN_2014-<span class="hljs-number">05</span>-<span class="hljs-number">12</span>]<span class="hljs-comment">#  bin/AMC13Tool -I 192.168.1.188</span>
Connecting to AMC13...
T2 ip <span class="hljs-number">192.168</span>.<span class="hljs-number">1.188</span>
T2 ip <span class="hljs-number">192.168</span>.<span class="hljs-number">1.188</span>
T1 ip <span class="hljs-number">192.168</span>.<span class="hljs-number">1.189</span>
Address map: file://map/AMC13_AddressTable_K7.<span class="hljs-keyword">xml</span>
<span class="hljs-title">Caught</span> Exception: Invalid <span class="hljs-keyword">node</span> <span class="hljs-title">ID</span> &#x27;<span class="hljs-number">1.0</span>V_ANA_PWR&#x27; specified (contains dots)
T1 <span class="hljs-number">192.168</span>.<span class="hljs-number">1.189</span> map/AMC13_AddressTable_K7.<span class="hljs-keyword">xml</span> <span class="hljs-title">1</span> <span class="hljs-number">1</span>
Failed to build T1 ipDev object!</code></pre></div>
<hr>
<h2 id="21032024-0016">21/03/2024 00:16</h2>
<p>Comparing our set-up with the CENPA DAQ, I think we have the Samtech cable plugged in correctly.<br>
<strong>Our bank chip:</strong></p>
<figure class="jop-noMdConv">
<img src="../_resources/a3a7df90b6654871bea047f5cec198a3.png" width="300" height="50" class="jop-noMdConv"/>
</figure>
<p><strong>CENPA bank chip:</strong></p>
<figure class="jop-noMdConv">
<img src="../_resources/1ac136ebcdbe4b8a995be05fec1d45e0.png" width="300" height="50" class="jop-noMdConv"/>
</figure>
<p><strong>Our FC7 connection:</strong></p>
<figure class="jop-noMdConv">
<img src="../_resources/78a2ad72e30d415f8a4a2c11e2a9e122.png" width="300" height="50" class="jop-noMdConv"/>
</figure>
<p><strong>CENPA FC7 connection:</strong></p>
<figure class="jop-noMdConv">
<img src="../_resources/f704e4f4aada42969a110fa09bce33f0.png" width="300" height="50" class="jop-noMdConv"/>
</figure>
<hr>
<h2 id="21032024-0050">21/03/2024 00:50</h2>
<p>Was able to set BARs size to 512MB</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at c0000000 (32-bit, non-prefetchable) [size=512M]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</pre><pre class="hljs"><code>[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at c0000000 (32-bit, non-prefetchable) [size=512M]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</code></pre></div>
<p>and write/readback:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 3221225472 w 0xffffff12
/dev/mem opened.
Target offset is 0xc0000000, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0xc0000000)
PCI Memory mapped to address 0x7fb23ee93000.
Value at offset 0xC0000000 (0x7fb23ee93000): 0x0
Written 0xFFFFFF12; readback 0xFFFFFF12
[root@fe01 pcimem]#</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 3221225472 w 0xffffff12</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0xc0000000</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0xc0000000</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7fb23ee93000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0xC0000000</span> (<span class="hljs-number">0x7fb23ee93000</span>): <span class="hljs-number">0x0</span>
Written <span class="hljs-number">0xFFFFFF12</span>; readback <span class="hljs-number">0xFFFFFF12</span>
[root@fe01 pcimem]<span class="hljs-comment">#</span></code></pre></div>
<hr>
<h2 id="21032024-0052">21/03/2024 00:52</h2>
<p>It looks like 1GB also works. I wonder what the issue with 2GB is:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at 80000000 (32-bit, non-prefetchable) [size=1G]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</pre><pre class="hljs"><code>[root@fe01 ~]# lspci -vv | grep -A 40 &quot;04:00.0&quot;
pcilib: sysfs_read_vpd: read failed: Input/output error
04:00.0 Memory controller: Xilinx Corporation Device 7024
        Subsystem: Xilinx Corporation Device 0007
        Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Interrupt: pin A routed to IRQ 35
        Region 0: Memory at 80000000 (32-bit, non-prefetchable) [size=1G]
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [60] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 512 bytes, PhantFunc 0, Latency L0s &lt;64ns, L1 unlimited
                        ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 225.000W
                DevCtl: Report errors: Correctable- Non-Fatal+ Fatal+ Unsupported-
                        RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend-
                LnkCap: Port #0, Speed 5GT/s, Width x4, ASPM L0s, Exit Latency L0s unlimited, L1 unlimited
                        ClockPM- Surprise- LLActRep- BwNot- ASPMOptComp-
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk+
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 5GT/s, Width x4, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range B, TimeoutDis-, LTR-, OBFF Not Supported
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v1] Device Serial Number 00-00-00-01-01-00-0a-35
        Kernel modules: xdma</code></pre></div>
<p>and the write/readback:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 2147483648 w 0xffffff12
/dev/mem opened.
Target offset is 0x80000000, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0x80000000)
PCI Memory mapped to address 0x7f716ae30000.
Value at offset 0x80000000 (0x7f716ae30000): 0x0
Written 0xFFFFFF12; readback 0xFFFFFF12</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 2147483648 w 0xffffff12</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0x80000000</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0x80000000</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7f716ae30000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0x80000000</span> (<span class="hljs-number">0x7f716ae30000</span>): <span class="hljs-number">0x0</span>
Written <span class="hljs-number">0xFFFFFF12</span>; readback <span class="hljs-number">0xFFFFFF12</span></code></pre></div>
<hr>
<h2 id="21032024-0141">21/03/2024 01:41</h2>
<p>I was playing with talking with the board over PCIe. I got ChatGPT to make me a script that reads multiple words:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;ctype.h&gt;
#include &lt;termios.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/time.h&gt;

#define PRINT_ERROR \
    do { \
        fprintf(stderr, &quot;Error at line %d, file %s (%d) [%s]\n&quot;, \
        __LINE__, __FILE__, errno, strerror(errno)); exit(1); \
    } while(0)

#define MAP_SIZE_DEFAULT 4096UL
#define MAP_MASK (MAP_SIZE_DEFAULT - 1)

int main(int argc, char **argv) {
    int fd;
    void *map_base, *virt_addr;
    uint32_t read_result;
    char *filename;
    off_t target;
    size_t word_count = 0;
    size_t map_size = MAP_SIZE_DEFAULT; // Default map size
    struct timeval start, end;
    double time_taken;

    if(argc &lt; 4 || argc &gt; 5) {
        fprintf(stderr, &quot;\nUsage:\t%s { sys file } { offset } { word count } [ map size ]\n&quot;
            &quot;\tsys file: sysfs file for the PCI resource to act on\n&quot;
            &quot;\toffset  : offset into PCI memory region to act upon\n&quot;
            &quot;\tword count: number of words to read\n&quot;
            &quot;\tmap size (optional): size of memory mapping in bytes (default: 4096)\n\n&quot;,
            argv[0]);
        exit(1);
    }
    
    filename = argv[1];
    target = strtoul(argv[2], 0, 0);
    word_count = atoi(argv[3]);

    if(argc == 5)
        map_size = atoi(argv[4]);

    if((fd = open(filename, O_RDWR | O_SYNC)) == -1) PRINT_ERROR;
    printf(&quot;%s opened.\n&quot;, filename);

    /* Map memory */
    map_base = mmap(0, map_size, PROT_READ, MAP_SHARED, fd, target &amp; ~MAP_MASK);
    if(map_base == (void *) -1) PRINT_ERROR;
    printf(&quot;PCI Memory mapped to address 0x%08lx with size %lu bytes.\n&quot;, (unsigned long) map_base, map_size);

    virt_addr = map_base;

    printf(&quot;Reading %lu words from offset 0x%lx:\n&quot;, word_count, (unsigned long)target);

    // Measure time taken to read
    gettimeofday(&amp;start, NULL);

    // Read and print the specified number of words
    for(size_t i = 0; i &lt; word_count; ++i) {
        read_result = *((uint32_t *) virt_addr);
        printf(&quot;0x%08x &quot;, read_result);
        virt_addr = (char *)virt_addr + sizeof(uint32_t); // Move to the next word
    }
    printf(&quot;\n&quot;);

    gettimeofday(&amp;end, NULL);

    // Calculate time taken in milliseconds
    time_taken = ((end.tv_sec - start.tv_sec) * 1000 + (end.tv_usec - start.tv_usec) / 1000.0);

    printf(&quot;Read operation completed in %.2f milliseconds.\n&quot;, time_taken);

    if(munmap(map_base, map_size) == -1) PRINT_ERROR;
    close(fd);
    return 0;
}</pre><pre class="hljs"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;ctype.h&gt;
#include &lt;termios.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/time.h&gt;

#define PRINT_ERROR \
    do { \
        fprintf(stderr, &quot;Error at line %d, file %s (%d) [%s]\n&quot;, \
        __LINE__, __FILE__, errno, strerror(errno)); exit(1); \
    } while(0)

#define MAP_SIZE_DEFAULT 4096UL
#define MAP_MASK (MAP_SIZE_DEFAULT - 1)

int main(int argc, char **argv) {
    int fd;
    void *map_base, *virt_addr;
    uint32_t read_result;
    char *filename;
    off_t target;
    size_t word_count = 0;
    size_t map_size = MAP_SIZE_DEFAULT; // Default map size
    struct timeval start, end;
    double time_taken;

    if(argc &lt; 4 || argc &gt; 5) {
        fprintf(stderr, &quot;\nUsage:\t%s { sys file } { offset } { word count } [ map size ]\n&quot;
            &quot;\tsys file: sysfs file for the PCI resource to act on\n&quot;
            &quot;\toffset  : offset into PCI memory region to act upon\n&quot;
            &quot;\tword count: number of words to read\n&quot;
            &quot;\tmap size (optional): size of memory mapping in bytes (default: 4096)\n\n&quot;,
            argv[0]);
        exit(1);
    }
    
    filename = argv[1];
    target = strtoul(argv[2], 0, 0);
    word_count = atoi(argv[3]);

    if(argc == 5)
        map_size = atoi(argv[4]);

    if((fd = open(filename, O_RDWR | O_SYNC)) == -1) PRINT_ERROR;
    printf(&quot;%s opened.\n&quot;, filename);

    /* Map memory */
    map_base = mmap(0, map_size, PROT_READ, MAP_SHARED, fd, target &amp; ~MAP_MASK);
    if(map_base == (void *) -1) PRINT_ERROR;
    printf(&quot;PCI Memory mapped to address 0x%08lx with size %lu bytes.\n&quot;, (unsigned long) map_base, map_size);

    virt_addr = map_base;

    printf(&quot;Reading %lu words from offset 0x%lx:\n&quot;, word_count, (unsigned long)target);

    // Measure time taken to read
    gettimeofday(&amp;start, NULL);

    // Read and print the specified number of words
    for(size_t i = 0; i &lt; word_count; ++i) {
        read_result = *((uint32_t *) virt_addr);
        printf(&quot;0x%08x &quot;, read_result);
        virt_addr = (char *)virt_addr + sizeof(uint32_t); // Move to the next word
    }
    printf(&quot;\n&quot;);

    gettimeofday(&amp;end, NULL);

    // Calculate time taken in milliseconds
    time_taken = ((end.tv_sec - start.tv_sec) * 1000 + (end.tv_usec - start.tv_usec) / 1000.0);

    printf(&quot;Read operation completed in %.2f milliseconds.\n&quot;, time_taken);

    if(munmap(map_base, map_size) == -1) PRINT_ERROR;
    close(fd);
    return 0;
}</code></pre></div>
<p>I'm pretty sure it works because I can write to registers with the <code class="inline-code">pcimem</code> script and see them appear when I read out, for example:<br>
To write the first 4 byte word:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 2147483648 w 0xffffff12
/dev/mem opened.
Target offset is 0x80000000, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0x80000000)
PCI Memory mapped to address 0x7f0a17ba3000.
Value at offset 0x80000000 (0x7f0a17ba3000): 0xFFFFFF12
Written 0xFFFFFF12; readback 0xFFFFFF12
[root@fe01 pcimem]#</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 2147483648 w 0xffffff12</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0x80000000</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0x80000000</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7f0a17ba3000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0x80000000</span> (<span class="hljs-number">0x7f0a17ba3000</span>): <span class="hljs-number">0xFFFFFF12</span>
Written <span class="hljs-number">0xFFFFFF12</span>; readback <span class="hljs-number">0xFFFFFF12</span>
[root@fe01 pcimem]<span class="hljs-comment">#</span></code></pre></div>
<p>To write the second 4 byte word:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 2147483652 w 0xffffff13
/dev/mem opened.
Target offset is 0x80000004, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0x80000004)
PCI Memory mapped to address 0x7fc7f1ba1000.
Value at offset 0x80000004 (0x7fc7f1ba1004): 0xFFFFFF12
Written 0xFFFFFF13; readback 0xFFFFFF13</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 2147483652 w 0xffffff13</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0x80000004</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0x80000004</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7fc7f1ba1000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0x80000004</span> (<span class="hljs-number">0x7fc7f1ba1004</span>): <span class="hljs-number">0xFFFFFF12</span>
Written <span class="hljs-number">0xFFFFFF13</span>; readback <span class="hljs-number">0xFFFFFF13</span></code></pre></div>
<p>Now we can read the first 3 4-byte words:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 3
/dev/mem opened.
PCI Memory mapped to address 0x7f1077abf000 with size 16384 bytes.
Reading 3 words from offset 0x80000000:
0xffffff12 0xffffff13 0x00000000
Read operation completed in 0.02 milliseconds.</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcie_read_dynamic /dev/mem 2147483648 3</span>
/dev/mem opened.
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7f1077abf000</span> <span class="hljs-keyword">with</span> size <span class="hljs-number">16384</span> bytes.
Reading <span class="hljs-number">3</span> <span class="hljs-built_in">words</span> <span class="hljs-keyword">from</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0x80000000</span>:
<span class="hljs-number">0xffffff12</span> <span class="hljs-number">0xffffff13</span> <span class="hljs-number">0x00000000</span>
Read operation completed <span class="hljs-keyword">in</span> <span class="hljs-number">0.02</span> milliseconds.</code></pre></div>
<p>I wrote one more word further out too and checked it:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcimem /dev/mem 2147484052 w 0xffffff14
/dev/mem opened.
Target offset is 0x80000194, page size is 4096
mmap(0, 4096, 0x3, 0x1, 3, 0x80000194)
PCI Memory mapped to address 0x7fe1af562000.
Value at offset 0x80000194 (0x7fe1af562194): 0xFFFFFF12
Written 0xFFFFFF14; readback 0xFFFFFF14</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcimem /dev/mem 2147484052 w 0xffffff14</span>
/dev/mem opened.
Target <span class="hljs-built_in">offset</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0x80000194</span>, page size <span class="hljs-keyword">is</span> <span class="hljs-number">4096</span>
mmap(<span class="hljs-number">0</span>, <span class="hljs-number">4096</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0x80000194</span>)
PCI Memory mapped <span class="hljs-keyword">to</span> address <span class="hljs-number">0x7fe1af562000</span>.
Value <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0x80000194</span> (<span class="hljs-number">0x7fe1af562194</span>): <span class="hljs-number">0xFFFFFF12</span>
Written <span class="hljs-number">0xFFFFFF14</span>; readback <span class="hljs-number">0xFFFFFF14</span></code></pre></div>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 110
/dev/mem opened.
PCI Memory mapped to address 0x7f2df0c91000 with size 4096 bytes.
Reading 110 words from offset 0x80000000:
0xffffff12 0xffffff13 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff14 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000
Read operation completed in 0.14 milliseconds.</pre><pre class="hljs"><code>[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 110
/dev/mem opened.
PCI Memory mapped to address 0x7f2df0c91000 with size 4096 bytes.
Reading 110 words from offset 0x80000000:
0xffffff12 0xffffff13 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff14 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000
Read operation completed in 0.14 milliseconds.</code></pre></div>
<p>However, I noticed that you can only read 512 4-byte words at a time before things start &quot;repeating&quot;.There is a max payload size of 512 bytes (as seen in lscpi output further up), but this seems like a different affect?</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 516
/dev/mem opened.
PCI Memory mapped to address 0x7fadda667000 with size 4096 bytes.
Reading 516 words from offset 0x80000000:
0xffffff12 0xffffff13 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff14 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff12 0xffffff13 0x00000000 0x00000000
Read operation completed in 0.48 milliseconds.</pre><pre class="hljs"><code>[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 516
/dev/mem opened.
PCI Memory mapped to address 0x7fadda667000 with size 4096 bytes.
Reading 516 words from offset 0x80000000:
0xffffff12 0xffffff13 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff14 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0xffffff12 0xffffff13 0x00000000 0x00000000
Read operation completed in 0.48 milliseconds.</code></pre></div>
<hr>
<h2 id="21032024-0159">21/03/2024 01:59</h2>
<p>I noticed with above we're only seeing a data rate of about 1 MB/s. This is the timed part:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">    // Measure time taken to read
    gettimeofday(&amp;start, NULL);

    // Read and print the specified number of words
    for(size_t i = 0; i &lt; word_count; ++i) {
        read_result = *((uint32_t *) virt_addr);
        printf(&quot;0x%08x &quot;, read_result);
        virt_addr = (char *)virt_addr + sizeof(uint32_t); // Move to the next word
    }
    printf(&quot;\n&quot;);

    gettimeofday(&amp;end, NULL);</pre><pre class="hljs"><code>    <span class="hljs-comment">// Measure time taken to read</span>
    <span class="hljs-built_in">gettimeofday</span>(&amp;start, <span class="hljs-literal">NULL</span>);

    <span class="hljs-comment">// Read and print the specified number of words</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; word_count; ++i) {
        read_result = *((<span class="hljs-type">uint32_t</span> *) virt_addr);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%08x &quot;</span>, read_result);
        virt_addr = (<span class="hljs-type">char</span> *)virt_addr + <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint32_t</span>); <span class="hljs-comment">// Move to the next word</span>
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);

    <span class="hljs-built_in">gettimeofday</span>(&amp;end, <span class="hljs-literal">NULL</span>);</code></pre></div>
<p>But I think this is actually just an artifact of printing. I editted the script to have more timing and removed the printout:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;ctype.h&gt;
#include &lt;termios.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/time.h&gt;

#define PRINT_ERROR \
    do { \
        fprintf(stderr, &quot;Error at line %d, file %s (%d) [%s]\n&quot;, \
        __LINE__, __FILE__, errno, strerror(errno)); exit(1); \
    } while(0)

#define MAP_SIZE_DEFAULT 4096UL
#define MAP_MASK (MAP_SIZE_DEFAULT - 1)

int main(int argc, char **argv) {
    int fd;
    void *map_base, *virt_addr;
    uint32_t *read_result;
    char *filename;
    off_t target;
    size_t word_count = 0;
    size_t map_size = MAP_SIZE_DEFAULT; // Default map size
    struct timeval start, end;
    long time_taken_microseconds;

    if(argc &lt; 4 || argc &gt; 5) {
        fprintf(stderr, &quot;\nUsage:\t%s { sys file } { offset } { word count } [ map size ]\n&quot;
            &quot;\tsys file: sysfs file for the PCI resource to act on\n&quot;
            &quot;\toffset  : offset into PCI memory region to act upon\n&quot;
            &quot;\tword count: number of words to read\n&quot;
            &quot;\tmap size (optional): size of memory mapping in bytes (default: 4096)\n\n&quot;,
            argv[0]);
        exit(1);
    }
    
    filename = argv[1];
    target = strtoul(argv[2], 0, 0);
    word_count = atoi(argv[3]);

    if(argc == 5)
        map_size = atoi(argv[4]);

    gettimeofday(&amp;start, NULL);
    if((fd = open(filename, O_RDWR | O_SYNC)) == -1) PRINT_ERROR;
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;%s opened in %ld microseconds.\n&quot;, filename, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    /* Map memory */
    map_base = mmap(0, map_size, PROT_READ, MAP_SHARED, fd, target &amp; ~MAP_MASK);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;PCI Memory mapped to address 0x%08lx with size %lu bytes in %ld microseconds.\n&quot;, (unsigned long) map_base, map_size, time_taken_microseconds);

    virt_addr = map_base;

    printf(&quot;Reading %lu words from offset 0x%lx in bulk mode:\n&quot;, word_count, (unsigned long)target);

    gettimeofday(&amp;start, NULL);
    // Read data in bulk mode
    read_result = (uint32_t *)virt_addr;
    for(size_t i = 0; i &lt; word_count; ++i) {
        //printf(&quot;0x%08x &quot;, read_result[i]);
    }
    printf(&quot;\n&quot;);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;Read operation completed in %ld microseconds.\n&quot;, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    if(munmap(map_base, map_size) == -1) PRINT_ERROR;
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;Memory unmapped in %ld microseconds.\n&quot;, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    close(fd);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;%s closed in %ld microseconds.\n&quot;, filename, time_taken_microseconds);

    return 0;
}
</pre><pre class="hljs"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;ctype.h&gt;
#include &lt;termios.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/time.h&gt;

#define PRINT_ERROR \
    do { \
        fprintf(stderr, &quot;Error at line %d, file %s (%d) [%s]\n&quot;, \
        __LINE__, __FILE__, errno, strerror(errno)); exit(1); \
    } while(0)

#define MAP_SIZE_DEFAULT 4096UL
#define MAP_MASK (MAP_SIZE_DEFAULT - 1)

int main(int argc, char **argv) {
    int fd;
    void *map_base, *virt_addr;
    uint32_t *read_result;
    char *filename;
    off_t target;
    size_t word_count = 0;
    size_t map_size = MAP_SIZE_DEFAULT; // Default map size
    struct timeval start, end;
    long time_taken_microseconds;

    if(argc &lt; 4 || argc &gt; 5) {
        fprintf(stderr, &quot;\nUsage:\t%s { sys file } { offset } { word count } [ map size ]\n&quot;
            &quot;\tsys file: sysfs file for the PCI resource to act on\n&quot;
            &quot;\toffset  : offset into PCI memory region to act upon\n&quot;
            &quot;\tword count: number of words to read\n&quot;
            &quot;\tmap size (optional): size of memory mapping in bytes (default: 4096)\n\n&quot;,
            argv[0]);
        exit(1);
    }
    
    filename = argv[1];
    target = strtoul(argv[2], 0, 0);
    word_count = atoi(argv[3]);

    if(argc == 5)
        map_size = atoi(argv[4]);

    gettimeofday(&amp;start, NULL);
    if((fd = open(filename, O_RDWR | O_SYNC)) == -1) PRINT_ERROR;
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;%s opened in %ld microseconds.\n&quot;, filename, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    /* Map memory */
    map_base = mmap(0, map_size, PROT_READ, MAP_SHARED, fd, target &amp; ~MAP_MASK);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;PCI Memory mapped to address 0x%08lx with size %lu bytes in %ld microseconds.\n&quot;, (unsigned long) map_base, map_size, time_taken_microseconds);

    virt_addr = map_base;

    printf(&quot;Reading %lu words from offset 0x%lx in bulk mode:\n&quot;, word_count, (unsigned long)target);

    gettimeofday(&amp;start, NULL);
    // Read data in bulk mode
    read_result = (uint32_t *)virt_addr;
    for(size_t i = 0; i &lt; word_count; ++i) {
        //printf(&quot;0x%08x &quot;, read_result[i]);
    }
    printf(&quot;\n&quot;);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;Read operation completed in %ld microseconds.\n&quot;, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    if(munmap(map_base, map_size) == -1) PRINT_ERROR;
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;Memory unmapped in %ld microseconds.\n&quot;, time_taken_microseconds);

    gettimeofday(&amp;start, NULL);
    close(fd);
    gettimeofday(&amp;end, NULL);
    time_taken_microseconds = ((end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec));
    printf(&quot;%s closed in %ld microseconds.\n&quot;, filename, time_taken_microseconds);

    return 0;
}
</code></pre></div>
<p>output:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 512
/dev/mem opened in 6 microseconds.
PCI Memory mapped to address 0x7f2302115000 with size 4096 bytes in 13 microseconds.
Reading 512 words from offset 0x80000000 in bulk mode:

Read operation completed in 7 microseconds.
Memory unmapped in 7 microseconds.
/dev/mem closed in 3 microseconds.</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcie_read_dynamic /dev/mem 2147483648 512</span>
/dev/mem opened in<span class="hljs-number"> 6 </span>microseconds.
PCI Memory mapped to address 0x7f2302115000 with size<span class="hljs-number"> 4096 </span>bytes in<span class="hljs-number"> 13 </span>microseconds.
Reading<span class="hljs-number"> 512 </span>words from offset 0x80000000 in bulk mode:

Read operation completed in<span class="hljs-number"> 7 </span>microseconds.
Memory unmapped in<span class="hljs-number"> 7 </span>microseconds.
/dev/mem closed in<span class="hljs-number"> 3 </span>microseconds.</code></pre></div>
<p>Though, this doesn't seem right because it doesn't scale, see trying to read 1 word:</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 1
/dev/mem opened in 6 microseconds.
PCI Memory mapped to address 0x7f897ac92000 with size 4096 bytes in 13 microseconds.
Reading 1 words from offset 0x80000000 in bulk mode:

Read operation completed in 11 microseconds.
Memory unmapped in 7 microseconds.
/dev/mem closed in 4 microseconds.
[root@fe01 pcimem]#</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcie_read_dynamic /dev/mem 2147483648 1</span>
/dev/mem opened in<span class="hljs-number"> 6 </span>microseconds.
PCI Memory mapped to address 0x7f897ac92000 with size<span class="hljs-number"> 4096 </span>bytes in<span class="hljs-number"> 13 </span>microseconds.
Reading<span class="hljs-number"> 1 </span>words from offset 0x80000000 in bulk mode:

Read operation completed in<span class="hljs-number"> 11 </span>microseconds.
Memory unmapped in<span class="hljs-number"> 7 </span>microseconds.
/dev/mem closed in<span class="hljs-number"> 4 </span>microseconds.
[root@fe01 pcimem]<span class="hljs-comment">#</span></code></pre></div>
<p>The size of the map doesn't seem to matter either (set to 4 bytes here):</p>
<div class="joplin-editable"><pre class="joplin-source" data-joplin-language="" data-joplin-source-open="```&#10;" data-joplin-source-close="&#10;```">[root@fe01 pcimem]# sudo ./pcie_read_dynamic /dev/mem 2147483648 4 4
/dev/mem opened in 7 microseconds.
PCI Memory mapped to address 0x7fcc26247000 with size 4 bytes in 13 microseconds.
Reading 4 words from offset 0x80000000 in bulk mode:

Read operation completed in 10 microseconds.
Memory unmapped in 7 microseconds.
/dev/mem closed in 4 microseconds.
[root@fe01 pcimem]#</pre><pre class="hljs"><code>[root@fe01 pcimem]<span class="hljs-comment"># sudo ./pcie_read_dynamic /dev/mem 2147483648 4 4</span>
/dev/mem opened in<span class="hljs-number"> 7 </span>microseconds.
PCI Memory mapped to address 0x7fcc26247000 with size<span class="hljs-number"> 4 </span>bytes in<span class="hljs-number"> 13 </span>microseconds.
Reading<span class="hljs-number"> 4 </span>words from offset 0x80000000 in bulk mode:

Read operation completed in<span class="hljs-number"> 10 </span>microseconds.
Memory unmapped in<span class="hljs-number"> 7 </span>microseconds.
/dev/mem closed in<span class="hljs-number"> 4 </span>microseconds.
[root@fe01 pcimem]<span class="hljs-comment">#</span></code></pre></div>
<p>I believe what's happening here is these timings are just overhead of these system operation of interacting with the memory map on the host computer. This script does not actually deal with any data transfer, rather, I think it incites data transfer (write to a virtual address mapped to target address, then some controller handles copying the data in the virtual address over). This makes timing the actual data transfer rate not as trivial as what I tried above.</p>
<hr>
</div></div>
					</body>
				</html>
			